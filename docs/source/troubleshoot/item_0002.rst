Detectors
=========

.. contents:: 
   :local:

Here we list detector specific information userful for troubleshooting and configure areadetector.

Flir
----

The area detector IOC controlling the FLIR camera run on the linux machine named pg10ge. To check the area detector status::

    user2bmb@pg10ge$ 2bmbOryx.sh status

To stop/restart area detector use ::

    user2bmb@pg10ge$ 2bmbOryx.sh start
    user2bmb@pg10ge$ 2bmbOryx.sh stop


To power cycle the camera unplug the power supply:

.. image:: ../img/camera.png 
   :width: 240px
   :align: center
   :alt: tomo_user


If the area detector fails to boot even after a camera power cycle, it means that the last auto save file (auto_setting.sav) is corrupted. To recover you need to replace the corrupted auto save with a good one::


    user2bmb@pg10ge$ 2bmbOryx.sh stop

then restart areadetector with::

    user2bmb@pg10ge$ ~/2bmbOryx.sh start


.. warning:: If the camera is not performing at the max speed (when set at 8-bit should run at 160 fps) but only runs at a lower speed (~95 fps or so) check the settings for the ISP Enable parameter is set to No. 

.. image:: ../img/camera_IspEnable.png 
   :width: 240px
   :align: center
   :alt: tomo_user

This is located in the Camera-specific features/Features #2 screen of the ADSpinnaker.adl screen.

Circular Buffer
~~~~~~~~~~~~~~~

The circular buffer plug-in is used in streaming mode to store 'past' images (taken before the capture starts) so that the recording includes data ahead of the event that triggered the data saving. The maximum number of frames buffered in the NDPluginCircularBuff plugin can be increased (within the available computer memory) by editing::

    # The maximum number of frames buffered in the NDPluginCircularBuff plugin
    epicsEnvSet("CBUFFS", "1500")

in the st.cmd.base file located in /net/s2dserv/xorApps/PreBuilts/areaDetector-R3-10/ADSpinnaker-R3-0/iocs/spinnakerIOC/iocBoot/iocSpinnaker::

    user2bmb@pg10ge$ cd /net/s2dserv/xorApps/PreBuilts/areaDetector-R3-10/ADSpinnaker-R3-0/iocs/spinnakerIOC/iocBoot/iocSpinnaker
    user2bmb@pg10ge$ sublime st.cmd.base

Point Grey
----------

The area detector IOC controlling the Point Grey camera run on the linux machine named lyra. To check the area detector status::

    [user2bmb@lyra]$ 2bmbPG3 status 

To stop/stop area detector use ::

    user2bmb@pg10ge$ 2bmbPG3 start
    user2bmb@pg10ge$ 2bmbPG3 stop
